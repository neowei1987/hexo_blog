---
title: 操作系统之文件系统介绍
date: 2021-01-03 19:47:03
updated:
copyright: true
password:
mathjax: true
---

![fd-inode](https://img-blog.csdnimg.cn/img_convert/b7691ff4fedc7a7abf5c35ba1869e550.png)

linux内核会为每一个进程创建一个task_truct结构体来维护进程信息，称之为 进程描述符，该结构体中 指针

struct files_struct *files


指向一个名称为file_struct的结构体，该结构体即 进程级别的文件描述表。

它的每一个条目记录的是单个文件描述符的相关信息

---

系统级别的文件描述符表
内核对系统中所有打开的文件维护了一个描述符表，也被称之为 【打开文件表】，表格中的每一项被称之为 【打开文件句柄】，一个【打开文件句柄】 描述了一个打开文件的全部信息。
主要包括：

当前文件偏移量（调用read()和write()时更新，或使用lseek()直接修改）
打开文件时所使用的状态标识（即，open()的flags参数）
文件访问模式（如调用open()时所设置的只读模式、只写模式或读写模式）
与信号驱动相关的设置
对该文件i-node对象的引用
文件类型（例如：常规文件、套接字或FIFO）和访问权限
一个指针，指向该文件所持有的锁列表
文件的各种属性，包括文件大小以及与不同类型操作相关的时间戳

---

Inode表
每个文件系统会为存储于其上的所有文件(包括目录)维护一个i-node表，单个i-node包含以下信息：

文件类型(file type)，可以是常规文件、目录、套接字或FIFO
访问权限
文件锁列表(file locks)
文件大小
等等
i-node存储在磁盘设备上，内核在内存中维护了一个副本，这里的i-node表为后者。副本除了原有信息，还包括：引用计数(从打开文件描述体)、所在设备号以及一些临时属性，例如文件锁。

---

为什么inode中没有文件名？

目录，也是文件。 文件内容是一个列表，列表项为：文件名 + inode
