操作系统中碰到的数据结构汇总

pid分配管理：bitmap pidmap_array

thread 与 thread_info 紧密挨着；根据esp 屏蔽 低13位 可以最快的获取thread_info;
同时进程描述符指针在thread_info中的偏移为0!

也就是将： OS将task_struct指针存放到了栈上（可以通过esp做简单的AND操作即可）

list_head 双向链表
hlist_head hlist_node 散列表拉链

提高调度程序运行速度：建立多个可运行程序链表

根据PID定位task：PID哈希表

等待队列（双向链表）：
用自旋锁加保护的等待队列头
等待队列链表的元素
等待队列中睡眠进程的唤醒：互斥进程，非互斥进程

进程切换

中断 IDT

每CPU变量：不需要同步的内核
数组，为每个cpu分配数组一元素
对不同CPU的并发访问提供保护，但是来自异步函数、内核抢占的访问不提供保护

原子操作
优化屏障、内存屏障

自旋锁、读写自旋锁

顺序锁（写者有较高优先级，当读者前后读到数据不一致时，重复读取）
系统相关的数据结构有使用！

RCU(读取-拷贝-更新)：只保护被动态分配并通过指针引用的数据结构
何时释放旧副本？ CPU经过静止状态后，定期检测！！

信号量

共享数据结构是一个单独的整数值，atomic_t
元素插入共享链表，涉及了两个指针赋值，写内存屏障可以避免看到坏的链表
获得自旋锁，必然禁止本地中断，本地软中断，自动禁止内核抢占

引用计数器（资源并发访问与释放而产生的竞争条件）

jiffies:子系统启动的节拍总数
顺序锁保护用于标志时钟中断数目64位计数器

软定时器
动态定时器的链表组（将同一时间段内即将到时的定时器归入一组）

NUMA
链表维护节点；节点包括管理区【硬件限制，ZONE_DMA, ZONE_NORMAL, ZONE_HIGHMEM】+page数组

pg_data_t
zone_t
page

将page到zone_t, pg_data_t的链接，以索引的形式存放到了page flag高位


动态内存分配与释放：管理区分配器 + 【伙伴系统 + 每CPU页框高速缓存】 * N